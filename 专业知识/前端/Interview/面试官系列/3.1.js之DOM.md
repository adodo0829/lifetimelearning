# DOM API

文档对象模型：DOM 将文档解析为一个由节点和对象（包含属性和方法的对象）组成的结构集合；是为了操作文档出现的 API，包括 document

## dom 树结构

节点树中的节点彼此拥有层级关系。
父（parent）、子（child）和同胞（sibling）等术语用于描述这些关系。父节点拥有子节点。同级的子节点被称为同胞（兄弟或姐妹）。

- 在节点树中，顶端节点被称为根（root）
  每个节点都有父节点、除了根（它没有父节点）
  一个节点可拥有任意数量的子
  同胞是拥有相同父节点的节点

通过 HTML DOM，树中的所有节点均可通过 JavaScript 进行访问。所有 HTML 元素（节点）均可被修改，也可以创建或删除节点。

## dom 事件流

事件流所描述的就是从页面中接受事件的顺序。

DOM 事件流（event flow）存在三个阶段：事件捕获阶段、处于目标阶段、事件冒泡阶段。

- 捕获阶段：一开始从文档的根节点流向目标对象；
- 目标阶段：然后在目标对向上被触发；
- 冒泡阶段：之后再回溯到文档的根节点。

### 事件捕获

当鼠标点击或者触发 dom 事件时，浏览器会从根节点开始由外到内进行事件传播，即点击了子元素，如果父元素通过事件捕获方式注册了对应的事件的话，会先触发父元素绑定的事件。

### 事件冒泡

与事件捕获恰恰相反，事件冒泡顺序是由内到外进行事件传播，直到根节点。

element.addEventListener(event, function, useCapture)
useCapture：默认值是 false，表示在事件冒泡阶段调用事件处理函数。如果参数为 true，则表示在事件捕获阶段调用处理函数。

基于事件冒泡机制，我们可以实现将子元素的事件委托给父级元素来进行处理。
当我们需要对很多元素添加事件的时候，可以通过将事件添加到它们的父节点而将事件委托给父节点来触发处理函数。

## 虚拟 DOM

随着应用程序越来越复杂，DOM 操作越来越频繁，需要监听事件和在事件回调用更新页面的 DOM 操作也越来越多，性能消耗则会比较大。
于是乎，虚拟 DOM 的想法便被人提出并实现了。

虚拟 DOM 其实是用来模拟真实 DOM 的中间产物，主要包括以下功能：

1. 用 JS 对象模拟 DOM 树，简化 DOM 对象。

简单来说，就是用一个对象模拟，保留主要的一些 DOM 属性，其他的则去掉。

2. 使用虚拟 DOM，结合操作 DOM 的接口，来生成真实 DOM。

使用假 DOM 生成真 DOM，同时保持真实 DOM 对象的引用，以便 3 步骤的执行。

3. 更新 DOM 时，比较两棵虚拟 DOM 树的差异，局部更新真实 DOM。

这个就比较有意思，可以根据数据的变化，来最小化地移动、替换、删除原有的 DOM 元素。
