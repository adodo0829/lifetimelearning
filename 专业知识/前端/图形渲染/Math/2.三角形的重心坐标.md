# 直线与三角形的重心坐标（Barycentric Coordinates）的推导与应用
https://zhuanlan.zhihu.com/p/361943207

## 求直线上任意一点

设我们有两个点 A 和 B，它们可以连成一条直线。那么该直线上的任意一点 P，必然满足：
比例 k 常数，AP = kAB

## 直线上的重心坐标

我们就知道直线 AB 上的任意一点 P，都可以由一个 k 来计算出来的。当然了，也可以通过 P 来推出 k 的值
设 j = 1 - k
则 P = jA + kB

这样的话我们 P 就可以使用 (j, k) 的方式来表示，这种表示方式就是我们的重心坐标。同时需要注意，因为重心坐标是根据某一条直线的 AB 两点所定义的，因此不同的直线各自会有各自的重心坐标。

## 线性插值

AB 两点内的任意一点满足：P = (1 - k)A + kB，我们将这个式子展开可以得到：
P = A + k(B - A)

一般情况下，我们 AB 两点是固定的，P 在 AB 之间移动，根据 P 的不同位置，我们可以算出 k 的值。这样我们就可以用这个特征来做 AB 之间其他属性的线性插值了。

例如假设 AB 两点同样代表两个颜色的值，求 AB 线段内任意一点 P 的颜色，只需要把 AB 的颜色值和通过 ABP 的位置求出来的 k 的值，带入上面的式子即可求出 P 的颜色值。

```c
public Image ImageA, ImageB, ImageP;
float A_x, B_x, P_x, k;
void Start()
{
    A_x = ImageA.transform.position.x;
    B_x = ImageB.transform.position.x;
}
void Update()
{
    P_x = ImageP.transform.position.x;
    //利用重心坐标，根据位置求出k
    k = (P_x - A_x) / (B_x - A_x);
    //用k计算出P的颜色，线性插值的方法
    ImageP.color = ImageA.color + k * (ImageB.color - ImageA.color);
}
```

## 三角形上的重心坐标

与直线上任意一点满足 P = jA + kB 一样，在三角形 ABC 所在平面上的任意一点 P 同样满足

P = iA + jB + kC
i + j + k = 1

那么 P 用 (i, j, k) 的方式表示，就是在三角形上的`重心坐标`。同样的，因为重心坐标是由三角形的三个顶点所定义的，因此不同的三角形有各自的重心坐标。

`同样的，若点 P 要在三角形内部或边上，需要满足 i >= 0，j >= 0，k >= 0，否则点 P 在三角形所在平面外。`

同样由于 P = (i+j+k)P = iP+jP+kP，因此我们可得到 iA+jB+kC-iP-jP-kP = 0 即：

## 三角形重心坐标的几何意义

​ 我们设三角形的总面积为 s，三角形 PBC 的面积为 a，三角形 PAB 的面积为 c，三角形 PCA 的面积为 b，那么可得
i,j.k 对应了对应各自的面积

## 实际应用场景

1.通过重心坐标来计算三角形内某点的坐标
P = iA + jB + kC

ABCP 代表的都是位置信息，我们可以通过位置信息求出重心坐标。而重心坐标牛逼就牛逼在，我们可以把 ABCD 的信息用别的任何信息来代替，例如颜色，法线，uv，深度等，然后套用上面的公式即可求出 P 点对应的属性。

在空间中的三角形或直线内的某个点，在投影变换前后，其的重心坐标可能会发生改变。因此有些计算，例如深度，一定要在投影变换前做，否则得到的结果可能是不对的。
